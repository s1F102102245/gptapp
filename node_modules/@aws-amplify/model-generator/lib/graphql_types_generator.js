import { generateStatements, generateTypes, } from '@aws-amplify/graphql-generator';
import { Source } from 'graphql';
/**
 * Generates GraphQL types for a given AppSync API
 */
export class AppSyncGraphqlTypesGenerator {
    fetchSchema;
    resultBuilder;
    /**
     * Configures the AppSyncGraphqlTypesGenerator
     */
    constructor(fetchSchema, resultBuilder) {
        this.fetchSchema = fetchSchema;
        this.resultBuilder = resultBuilder;
    }
    generateTypes = async ({ target, multipleSwiftFiles, }) => {
        const schema = await this.fetchSchema();
        if (!schema) {
            throw new Error('Invalid schema');
        }
        const generatedStatements = generateStatements({
            schema,
            target: 'graphql',
        });
        const queries = Object.entries(generatedStatements).map(([filename, contents]) => new Source(contents, filename));
        const generatedTypes = await generateTypes({
            schema,
            target,
            queries,
            multipleSwiftFiles,
        });
        return this.resultBuilder(generatedTypes);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JhcGhxbF90eXBlc19nZW5lcmF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvZ3JhcGhxbF90eXBlc19nZW5lcmF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLGtCQUFrQixFQUNsQixhQUFhLEdBQ2QsTUFBTSxnQ0FBZ0MsQ0FBQztBQUN4QyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBT2pDOztHQUVHO0FBQ0gsTUFBTSxPQUFPLDRCQUE0QjtJQUs3QjtJQUNBO0lBTFY7O09BRUc7SUFDSCxZQUNVLFdBQWtDLEVBQ2xDLGFBQW9FO1FBRHBFLGdCQUFXLEdBQVgsV0FBVyxDQUF1QjtRQUNsQyxrQkFBYSxHQUFiLGFBQWEsQ0FBdUQ7SUFDM0UsQ0FBQztJQUVKLGFBQWEsR0FBRyxLQUFLLEVBQUUsRUFDckIsTUFBTSxFQUNOLGtCQUFrQixHQUNRLEVBQUUsRUFBRTtRQUM5QixNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUV4QyxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ1gsTUFBTSxJQUFJLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1NBQ25DO1FBRUQsTUFBTSxtQkFBbUIsR0FBRyxrQkFBa0IsQ0FBQztZQUM3QyxNQUFNO1lBQ04sTUFBTSxFQUFFLFNBQVM7U0FDbEIsQ0FBQyxDQUFDO1FBRUgsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLEdBQUcsQ0FDckQsQ0FBQyxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxNQUFNLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUN6RCxDQUFDO1FBRUYsTUFBTSxjQUFjLEdBQUcsTUFBTSxhQUFhLENBQUM7WUFDekMsTUFBTTtZQUNOLE1BQU07WUFDTixPQUFPO1lBQ1Asa0JBQWtCO1NBQ25CLENBQUMsQ0FBQztRQUVILE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUM1QyxDQUFDLENBQUM7Q0FDSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGdlbmVyYXRlU3RhdGVtZW50cyxcbiAgZ2VuZXJhdGVUeXBlcyxcbn0gZnJvbSAnQGF3cy1hbXBsaWZ5L2dyYXBocWwtZ2VuZXJhdG9yJztcbmltcG9ydCB7IFNvdXJjZSB9IGZyb20gJ2dyYXBocWwnO1xuaW1wb3J0IHtcbiAgR2VuZXJhdGlvblJlc3VsdCxcbiAgR3JhcGhxbFR5cGVzR2VuZXJhdG9yLFxuICBUeXBlc0dlbmVyYXRpb25QYXJhbWV0ZXJzLFxufSBmcm9tICcuL21vZGVsX2dlbmVyYXRvci5qcyc7XG5cbi8qKlxuICogR2VuZXJhdGVzIEdyYXBoUUwgdHlwZXMgZm9yIGEgZ2l2ZW4gQXBwU3luYyBBUElcbiAqL1xuZXhwb3J0IGNsYXNzIEFwcFN5bmNHcmFwaHFsVHlwZXNHZW5lcmF0b3IgaW1wbGVtZW50cyBHcmFwaHFsVHlwZXNHZW5lcmF0b3Ige1xuICAvKipcbiAgICogQ29uZmlndXJlcyB0aGUgQXBwU3luY0dyYXBocWxUeXBlc0dlbmVyYXRvclxuICAgKi9cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBmZXRjaFNjaGVtYTogKCkgPT4gUHJvbWlzZTxzdHJpbmc+LFxuICAgIHByaXZhdGUgcmVzdWx0QnVpbGRlcjogKGZpbGVNYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4pID0+IEdlbmVyYXRpb25SZXN1bHRcbiAgKSB7fVxuXG4gIGdlbmVyYXRlVHlwZXMgPSBhc3luYyAoe1xuICAgIHRhcmdldCxcbiAgICBtdWx0aXBsZVN3aWZ0RmlsZXMsXG4gIH06IFR5cGVzR2VuZXJhdGlvblBhcmFtZXRlcnMpID0+IHtcbiAgICBjb25zdCBzY2hlbWEgPSBhd2FpdCB0aGlzLmZldGNoU2NoZW1hKCk7XG5cbiAgICBpZiAoIXNjaGVtYSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHNjaGVtYScpO1xuICAgIH1cblxuICAgIGNvbnN0IGdlbmVyYXRlZFN0YXRlbWVudHMgPSBnZW5lcmF0ZVN0YXRlbWVudHMoe1xuICAgICAgc2NoZW1hLFxuICAgICAgdGFyZ2V0OiAnZ3JhcGhxbCcsXG4gICAgfSk7XG5cbiAgICBjb25zdCBxdWVyaWVzID0gT2JqZWN0LmVudHJpZXMoZ2VuZXJhdGVkU3RhdGVtZW50cykubWFwKFxuICAgICAgKFtmaWxlbmFtZSwgY29udGVudHNdKSA9PiBuZXcgU291cmNlKGNvbnRlbnRzLCBmaWxlbmFtZSlcbiAgICApO1xuXG4gICAgY29uc3QgZ2VuZXJhdGVkVHlwZXMgPSBhd2FpdCBnZW5lcmF0ZVR5cGVzKHtcbiAgICAgIHNjaGVtYSxcbiAgICAgIHRhcmdldCxcbiAgICAgIHF1ZXJpZXMsXG4gICAgICBtdWx0aXBsZVN3aWZ0RmlsZXMsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5yZXN1bHRCdWlsZGVyKGdlbmVyYXRlZFR5cGVzKTtcbiAgfTtcbn1cbiJdfQ==