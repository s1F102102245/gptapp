import { Construct } from 'constructs';
import { Code, Function, Runtime } from 'aws-cdk-lib/aws-lambda';
import { AttributionMetadataStorage } from '@aws-amplify/backend-output-storage';
import { Stack } from 'aws-cdk-lib';
import { fileURLToPath } from 'url';
// Be very careful editing this value. It is the string that is used to attribute stacks to Amplify Function in BI metrics
const functionStackType = 'function-Lambda';
/**
 * Hello world construct implementation
 */
export class AmplifyLambdaFunction extends Construct {
    resources;
    /**
     * Create a new AmplifyConstruct
     */
    constructor(scope, id, props) {
        super(scope, id);
        this.resources = {
            lambda: new Function(this, `${id}LambdaFunction`, {
                code: Code.fromAsset(props.absoluteCodePath),
                runtime: props.runtime || Runtime.NODEJS_18_X,
                handler: props.handler || 'index.handler',
            }),
        };
        new AttributionMetadataStorage().storeAttributionMetadata(Stack.of(this), functionStackType, fileURLToPath(new URL('../package.json', import.meta.url)));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uc3RydWN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NvbnN0cnVjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBRWpFLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLHFDQUFxQyxDQUFDO0FBQ2pGLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDcEMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLEtBQUssQ0FBQztBQUVwQywwSEFBMEg7QUFDMUgsTUFBTSxpQkFBaUIsR0FBRyxpQkFBaUIsQ0FBQztBQVE1Qzs7R0FFRztBQUNILE1BQU0sT0FBTyxxQkFDWCxTQUFRLFNBQVM7SUFHUixTQUFTLENBQW9CO0lBQ3RDOztPQUVHO0lBQ0gsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUEyQjtRQUNuRSxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRWpCLElBQUksQ0FBQyxTQUFTLEdBQUc7WUFDZixNQUFNLEVBQUUsSUFBSSxRQUFRLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxnQkFBZ0IsRUFBRTtnQkFDaEQsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDO2dCQUM1QyxPQUFPLEVBQUUsS0FBSyxDQUFDLE9BQU8sSUFBSSxPQUFPLENBQUMsV0FBVztnQkFDN0MsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPLElBQUksZUFBZTthQUMxQyxDQUFDO1NBQ0gsQ0FBQztRQUVGLElBQUksMEJBQTBCLEVBQUUsQ0FBQyx3QkFBd0IsQ0FDdkQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFDZCxpQkFBaUIsRUFDakIsYUFBYSxDQUFDLElBQUksR0FBRyxDQUFDLGlCQUFpQixFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FDM0QsQ0FBQztJQUNKLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0IHsgQ29kZSwgRnVuY3Rpb24sIFJ1bnRpbWUgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtbGFtYmRhJztcbmltcG9ydCB7IEFtcGxpZnlGdW5jdGlvbiwgRnVuY3Rpb25SZXNvdXJjZXMgfSBmcm9tICdAYXdzLWFtcGxpZnkvcGx1Z2luLXR5cGVzJztcbmltcG9ydCB7IEF0dHJpYnV0aW9uTWV0YWRhdGFTdG9yYWdlIH0gZnJvbSAnQGF3cy1hbXBsaWZ5L2JhY2tlbmQtb3V0cHV0LXN0b3JhZ2UnO1xuaW1wb3J0IHsgU3RhY2sgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBmaWxlVVJMVG9QYXRoIH0gZnJvbSAndXJsJztcblxuLy8gQmUgdmVyeSBjYXJlZnVsIGVkaXRpbmcgdGhpcyB2YWx1ZS4gSXQgaXMgdGhlIHN0cmluZyB0aGF0IGlzIHVzZWQgdG8gYXR0cmlidXRlIHN0YWNrcyB0byBBbXBsaWZ5IEZ1bmN0aW9uIGluIEJJIG1ldHJpY3NcbmNvbnN0IGZ1bmN0aW9uU3RhY2tUeXBlID0gJ2Z1bmN0aW9uLUxhbWJkYSc7XG5cbmV4cG9ydCB0eXBlIEFtcGxpZnlGdW5jdGlvblByb3BzID0ge1xuICBhYnNvbHV0ZUNvZGVQYXRoOiBzdHJpbmc7XG4gIHJ1bnRpbWU/OiBSdW50aW1lO1xuICBoYW5kbGVyPzogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBIZWxsbyB3b3JsZCBjb25zdHJ1Y3QgaW1wbGVtZW50YXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIEFtcGxpZnlMYW1iZGFGdW5jdGlvblxuICBleHRlbmRzIENvbnN0cnVjdFxuICBpbXBsZW1lbnRzIEFtcGxpZnlGdW5jdGlvblxue1xuICByZWFkb25seSByZXNvdXJjZXM6IEZ1bmN0aW9uUmVzb3VyY2VzO1xuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IEFtcGxpZnlDb25zdHJ1Y3RcbiAgICovXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBBbXBsaWZ5RnVuY3Rpb25Qcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICB0aGlzLnJlc291cmNlcyA9IHtcbiAgICAgIGxhbWJkYTogbmV3IEZ1bmN0aW9uKHRoaXMsIGAke2lkfUxhbWJkYUZ1bmN0aW9uYCwge1xuICAgICAgICBjb2RlOiBDb2RlLmZyb21Bc3NldChwcm9wcy5hYnNvbHV0ZUNvZGVQYXRoKSxcbiAgICAgICAgcnVudGltZTogcHJvcHMucnVudGltZSB8fCBSdW50aW1lLk5PREVKU18xOF9YLFxuICAgICAgICBoYW5kbGVyOiBwcm9wcy5oYW5kbGVyIHx8ICdpbmRleC5oYW5kbGVyJyxcbiAgICAgIH0pLFxuICAgIH07XG5cbiAgICBuZXcgQXR0cmlidXRpb25NZXRhZGF0YVN0b3JhZ2UoKS5zdG9yZUF0dHJpYnV0aW9uTWV0YWRhdGEoXG4gICAgICBTdGFjay5vZih0aGlzKSxcbiAgICAgIGZ1bmN0aW9uU3RhY2tUeXBlLFxuICAgICAgZmlsZVVSTFRvUGF0aChuZXcgVVJMKCcuLi9wYWNrYWdlLmpzb24nLCBpbXBvcnQubWV0YS51cmwpKVxuICAgICk7XG4gIH1cbn1cbiJdfQ==