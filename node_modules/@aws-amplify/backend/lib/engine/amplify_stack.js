import { Stack } from 'aws-cdk-lib';
/**
 * Amplify-specific Stack implementation to handle cross-cutting concerns for all Amplify stacks
 */
export class AmplifyStack extends Stack {
    /**
     * Overrides Stack.allocateLogicalId to prevent redundant nested stack logical IDs
     */
    allocateLogicalId = (element) => {
        // Nested stack logical IDs have a redundant structure of <name>NestedStack<name>NestedStackResource<hash>
        // This rewrites the nested stack logical ID to <name><hash>
        const defaultId = super.allocateLogicalId(element);
        const match = /(?<name>.*)NestedStack.+NestedStackResource(?<hash>.*)/.exec(defaultId);
        if (match && match.groups && Object.keys(match.groups || {}).length === 2) {
            return `${match.groups.name}${match.groups.hash}`;
        }
        return defaultId;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW1wbGlmeV9zdGFjay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lbmdpbmUvYW1wbGlmeV9zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQWMsS0FBSyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBRWhEOztHQUVHO0FBQ0gsTUFBTSxPQUFPLFlBQWEsU0FBUSxLQUFLO0lBQ3JDOztPQUVHO0lBQ0gsaUJBQWlCLEdBQUcsQ0FBQyxPQUFtQixFQUFVLEVBQUU7UUFDbEQsMEdBQTBHO1FBQzFHLDREQUE0RDtRQUM1RCxNQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDbkQsTUFBTSxLQUFLLEdBQUcsd0RBQXdELENBQUMsSUFBSSxDQUN6RSxTQUFTLENBQ1YsQ0FBQztRQUNGLElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDekUsT0FBTyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDbkQ7UUFDRCxPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDLENBQUM7Q0FDSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENmbkVsZW1lbnQsIFN0YWNrIH0gZnJvbSAnYXdzLWNkay1saWInO1xuXG4vKipcbiAqIEFtcGxpZnktc3BlY2lmaWMgU3RhY2sgaW1wbGVtZW50YXRpb24gdG8gaGFuZGxlIGNyb3NzLWN1dHRpbmcgY29uY2VybnMgZm9yIGFsbCBBbXBsaWZ5IHN0YWNrc1xuICovXG5leHBvcnQgY2xhc3MgQW1wbGlmeVN0YWNrIGV4dGVuZHMgU3RhY2sge1xuICAvKipcbiAgICogT3ZlcnJpZGVzIFN0YWNrLmFsbG9jYXRlTG9naWNhbElkIHRvIHByZXZlbnQgcmVkdW5kYW50IG5lc3RlZCBzdGFjayBsb2dpY2FsIElEc1xuICAgKi9cbiAgYWxsb2NhdGVMb2dpY2FsSWQgPSAoZWxlbWVudDogQ2ZuRWxlbWVudCk6IHN0cmluZyA9PiB7XG4gICAgLy8gTmVzdGVkIHN0YWNrIGxvZ2ljYWwgSURzIGhhdmUgYSByZWR1bmRhbnQgc3RydWN0dXJlIG9mIDxuYW1lPk5lc3RlZFN0YWNrPG5hbWU+TmVzdGVkU3RhY2tSZXNvdXJjZTxoYXNoPlxuICAgIC8vIFRoaXMgcmV3cml0ZXMgdGhlIG5lc3RlZCBzdGFjayBsb2dpY2FsIElEIHRvIDxuYW1lPjxoYXNoPlxuICAgIGNvbnN0IGRlZmF1bHRJZCA9IHN1cGVyLmFsbG9jYXRlTG9naWNhbElkKGVsZW1lbnQpO1xuICAgIGNvbnN0IG1hdGNoID0gLyg/PG5hbWU+LiopTmVzdGVkU3RhY2suK05lc3RlZFN0YWNrUmVzb3VyY2UoPzxoYXNoPi4qKS8uZXhlYyhcbiAgICAgIGRlZmF1bHRJZFxuICAgICk7XG4gICAgaWYgKG1hdGNoICYmIG1hdGNoLmdyb3VwcyAmJiBPYmplY3Qua2V5cyhtYXRjaC5ncm91cHMgfHwge30pLmxlbmd0aCA9PT0gMikge1xuICAgICAgcmV0dXJuIGAke21hdGNoLmdyb3Vwcy5uYW1lfSR7bWF0Y2guZ3JvdXBzLmhhc2h9YDtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRJZDtcbiAgfTtcbn1cbiJdfQ==