import { SecretValue } from 'aws-cdk-lib';
/**
 * Resolves a backend secret to a CFN token via a lambda-backed CFN custom resource.
 */
export class CfnTokenBackendSecret {
    name;
    secretResourceFactory;
    /**
     * The name of the secret to fetch.
     */
    constructor(name, secretResourceFactory) {
        this.name = name;
        this.secretResourceFactory = secretResourceFactory;
    }
    /**
     * Get a reference to the value within a CDK scope.
     */
    resolve = (scope, backendIdentifier) => {
        const secretResource = this.secretResourceFactory.getOrCreate(scope, this.name, backendIdentifier);
        const val = secretResource.getAttString('secretValue');
        return SecretValue.unsafePlainText(val); // safe since 'val' is a cdk token.
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2VuZF9zZWNyZXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZW5naW5lL2JhY2tlbmQtc2VjcmV0L2JhY2tlbmRfc2VjcmV0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFFMUM7O0dBRUc7QUFDSCxNQUFNLE9BQU8scUJBQXFCO0lBS2I7SUFDQTtJQUxuQjs7T0FFRztJQUNILFlBQ21CLElBQVksRUFDWixxQkFBa0Q7UUFEbEQsU0FBSSxHQUFKLElBQUksQ0FBUTtRQUNaLDBCQUFxQixHQUFyQixxQkFBcUIsQ0FBNkI7SUFDbEUsQ0FBQztJQUNKOztPQUVHO0lBQ0gsT0FBTyxHQUFHLENBQ1IsS0FBZ0IsRUFDaEIsaUJBQW9DLEVBQ3ZCLEVBQUU7UUFDZixNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMscUJBQXFCLENBQUMsV0FBVyxDQUMzRCxLQUFLLEVBQ0wsSUFBSSxDQUFDLElBQUksRUFDVCxpQkFBaUIsQ0FDbEIsQ0FBQztRQUVGLE1BQU0sR0FBRyxHQUFHLGNBQWMsQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDdkQsT0FBTyxXQUFXLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsbUNBQW1DO0lBQzlFLENBQUMsQ0FBQztDQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFja2VuZElkZW50aWZpZXIsIEJhY2tlbmRTZWNyZXQgfSBmcm9tICdAYXdzLWFtcGxpZnkvcGx1Z2luLXR5cGVzJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0IHsgQmFja2VuZFNlY3JldEZldGNoZXJGYWN0b3J5IH0gZnJvbSAnLi9iYWNrZW5kX3NlY3JldF9mZXRjaGVyX2ZhY3RvcnkuanMnO1xuaW1wb3J0IHsgU2VjcmV0VmFsdWUgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5cbi8qKlxuICogUmVzb2x2ZXMgYSBiYWNrZW5kIHNlY3JldCB0byBhIENGTiB0b2tlbiB2aWEgYSBsYW1iZGEtYmFja2VkIENGTiBjdXN0b20gcmVzb3VyY2UuXG4gKi9cbmV4cG9ydCBjbGFzcyBDZm5Ub2tlbkJhY2tlbmRTZWNyZXQgaW1wbGVtZW50cyBCYWNrZW5kU2VjcmV0IHtcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBzZWNyZXQgdG8gZmV0Y2guXG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlYWRvbmx5IG5hbWU6IHN0cmluZyxcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNlY3JldFJlc291cmNlRmFjdG9yeTogQmFja2VuZFNlY3JldEZldGNoZXJGYWN0b3J5XG4gICkge31cbiAgLyoqXG4gICAqIEdldCBhIHJlZmVyZW5jZSB0byB0aGUgdmFsdWUgd2l0aGluIGEgQ0RLIHNjb3BlLlxuICAgKi9cbiAgcmVzb2x2ZSA9IChcbiAgICBzY29wZTogQ29uc3RydWN0LFxuICAgIGJhY2tlbmRJZGVudGlmaWVyOiBCYWNrZW5kSWRlbnRpZmllclxuICApOiBTZWNyZXRWYWx1ZSA9PiB7XG4gICAgY29uc3Qgc2VjcmV0UmVzb3VyY2UgPSB0aGlzLnNlY3JldFJlc291cmNlRmFjdG9yeS5nZXRPckNyZWF0ZShcbiAgICAgIHNjb3BlLFxuICAgICAgdGhpcy5uYW1lLFxuICAgICAgYmFja2VuZElkZW50aWZpZXJcbiAgICApO1xuXG4gICAgY29uc3QgdmFsID0gc2VjcmV0UmVzb3VyY2UuZ2V0QXR0U3RyaW5nKCdzZWNyZXRWYWx1ZScpO1xuICAgIHJldHVybiBTZWNyZXRWYWx1ZS51bnNhZmVQbGFpblRleHQodmFsKTsgLy8gc2FmZSBzaW5jZSAndmFsJyBpcyBhIGNkayB0b2tlbi5cbiAgfTtcbn1cbiJdfQ==